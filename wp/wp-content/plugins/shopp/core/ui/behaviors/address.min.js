!function(e){jQuery.fn.upstate=function(){if("undefined"!=typeof regions)return e(this).change(function(i,s){var t=e(this),a=t.attr("id").split("-")[0],n=t.val(),r=t.parents().find("#"+a+"-state"),d=t.parents().find("#"+a+"-state-menu"),l='<option value=""></option>';return 0==d.length||(d.hasClass("hidden")&&d.removeClass("hidden").hide(),void(regions[n]||s&&d.find("option").length>1?(r.setDisabled(!0).addClass("_important").hide(),regions[n]?(e.each(regions[n],function(e,i){l+='<option value="'+e+'">'+i+"</option>"}),s||d.empty().append(l).setDisabled(!1).show().focus(),d.hasClass("auto-required")&&d.addClass("required")):d.hasClass("auto-required")&&d.removeClass("required"),d.setDisabled(!1).show(),e("label[for="+r.attr("id")+"]").attr("for",d.attr("id"))):(d.empty().setDisabled(!0).hide(),r.setDisabled(!1).show().removeClass("_important"),e("label[for="+d.attr("id")+"]").attr("for",r.attr("id")),s||r.val("").focus())))}).trigger("change",[!0]),e(this)}}(jQuery),jQuery(document).ready(function(e){var i=e(".sameaddress"),s=e("#shipping-address-fields"),t=e("#billing-address-fields");e("#firstname,#lastname").change(function(){var i="firstname"==e(this).attr("id")?"lastname":"firstname";e("#"+i).val().trim()&&e(this).val().trim()&&e("#billing-name,#shipping-name").filter(function(){return""===this.value}).val(new String(e("#firstname").val()+" "+e("#lastname").val()).trim())}),e("#billing-country,#shipping-country").upstate(),i.change(function(a,n){var r=!1,d=e("#billing-country"),l=e("#shipping-country"),o="billing"==i.val()?s:t,u="shipping"==i.val()?s:t;i.is(":checked")?(o.removeClass("half"),u.hide().find(".required").setDisabled(!0)):(o.addClass("half"),u.show().find(".disabled:not(._important)").setDisabled(!1),n||(r=!0)),d.is(":visible")&&d.trigger("change.localemenu",[n]),l.is(":visible")&&l.trigger("change.localemenu",[n]),r&&u.find("input:first").focus()}).trigger("change",[!0]).click(function(){e(this).change()}),e("#billing-country,#shipping-country").change(function(){if("undefined"!=typeof $shopp_address){var i=e(this).attr("id").split("-")[0],s=e(this).val();$shopp_address.country_no_postal_codes.indexOf(s)>-1?e("#"+i+"-postcode").removeClass("required"):e("#"+i+"-postcode").addClass("required")}})});